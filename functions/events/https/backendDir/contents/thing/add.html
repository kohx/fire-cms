{|@ wrapper |}
{|> header |}

<div class="col0 grid1 gap2">
    <div class="col1">
        <label for="order">order</label>
        <input id="order" name='order' class="target_item" type="text">
    </div>
    <div class="col1">
        <label for="unique">unique</label>
        <input id="unique" name="unique" class="target_item" type="text">
    </div>
    <div class="col1">
        <label for="name">name</label>
        <input id="name" name="name" class="target_item" type="text">
    </div>
    <div class="col1">
        <span for="parents">parents</span>
        <input id="parents" name="parents" class="target_item" type="text">
    </div>
    <div class="col1">
        <span>roles</span>
        <div>
            {| *roles : role |}<input id="{| role |}" type="checkbox" name="roles" value="{| role |}"><label for="{| role |}">{| role |}</label>{| /* |}
        </div>
    </div>
    <div class="col1">
        <label for="issue">issue</label>
        <input id="issue" name="issue" class="target_item" type="datetime-local">
    </div>
    <div class="col1">
        <label for="description">description</label>
        <textarea id="description" name="description" class="target_item"></textarea>
    </div>
    <div class="col1">
        <label for="summary">summary</label>
        <textarea id="summary" name="summary" class="target_item"></textarea>
    </div>
    <div class="col1">
        <label for="summary">keywords</label>
        <i class="fas fa-plus-circle plus"></i>
        <div>
            <input id="keywords" name="keywords" class="target_item" type="text">
        </div>
    </div>
    <div class="col1">
        <label for="content">content</label>
        <textarea id="content" name="content" class="target_item"></textarea>
    </div>
    <button class="col1 target_item" type="button" id="create_button" data-request_url="{| backendFirstPath |}/thing-create" data-redirect_url="{| backendFirstPath |}/thing">create</button>
</div>

{|> footer |}
<script type="module">

    import { Base } from '/{| backendFirstPath |}/base.js';
    var base = Base.init()

    const plusElements = document.querySelectorAll('.plus')
    plusElements.forEach(plusElement => {
        plusElement.addEventListener('click', event => {
            const element = event.currentTarget.nextElementSibling
            const copy = element.cloneNode(true)
            const minusElement = document.createElement('i')
            minusElement.classList.add('fas', 'fa-minus-circle')
            minusElement.addEventListener('click', minusEvent => {
                minusEvent.currentTarget.parentElement.remove()
            })
            copy.querySelector('input').value = ''
            copy.insertAdjacentElement('afterbegin', minusElement)
            element.parentElement.insertAdjacentElement('beforeend', copy)
        })
    })

    // codemirror
    const contentElement = document.querySelector('#content')
    const editor = CodeMirror.fromTextArea(contentElement)

    // get element
    const createBtnElement = document.querySelector('#create_button')

    // click event
    createBtnElement.addEventListener('click', event => {

        // codemirror to textarea
        editor.save()

        // get button
        const button = event.currentTarget

        // not change then show warnning
        base.requestServer(button)
    })

</script>